<h2 id="application">Application</h2><p>An <code>Application</code> in Stormpath represents any real world piece of software that communicates with Stormpath to offload its user management and authentication needs - like a Node.js application.</p><p>You control who may login to an application by assigning (or ‘mapping’) one or more <a href="directory">Directories</a> or <a href="group">Groups</a> (generically both called <em>account stores</em>) to an application. The Accounts in these associated directories or groups (again, <em>account stores</em>) collectively form the application’s user base. These accounts are considered the application’s users and they can login to the application. Therefore, you can control user population that may login to an application by managing which account stores are assigned to the application.</p><p>Even the Stormpath Admin Console and API is represented as an <code>Application</code> (named &#39;Stormpath&#39;), so you can control who has administrative access to your Stormpath tenant by managing the Stormpath application’s associated account stores.</p><p><strong>Since</strong>: 0.1</p><hr><p><a name="authenticateAccount"></a></p><h3 id="-span-class-member-method-span-authenticateaccount-authenticationrequest-callback-"><span class="member">method</span> authenticateAccount(authenticationRequest, callback)</h3><p>Performs an authentication attempt for an application account via the supplied <code>authenticationRequest</code> argument, providing the returned <a href="authenticationResult">AuthenticationResult</a> to the specified <code>callback</code>.</p><h4 id="usage">Usage</h4><p>Authenticate your application user accounts with a simple username/password pair:</p><pre><code class="lang-javascript">var authcRequest = {
  username: &#39;jlpicard&#39;, //username can be an email address too
  password: &#39;RawPassw0rd!&#39;
};

application.authenticateAccount(authcRequest, function(err, result) {
  // if successful, the result will have an account field with the successfully authenticated account:
  result.getAccount(function(err, account) {
    console.log(account);
  });
};</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>authenticationRequest</code><td><code>object</code><td>required<td>Object with two required name/value pairs: <code>username</code> and <code>password</code> and one optional <code>accountStore</code>. <code>username</code> can be either a username or email address. <code>password</code> is the <em>raw</em> password submitted directly by your application user. Stormpath hashes and encrypts this value securely automatically - you don&#39;t have to do anything special before submitting to Stormpath. If you desire to target a specific <code>accountStore</code>, then provide reference to the <code>accountStore</code> in options. If <code>accountStore</code> is provided as a string an account store HREF is expected, otherwise it expects an object that identifies the account store, e.g. <code>{ nameKey: &#39;organizaiton nameKey&#39; }</code>.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="authenticationResult">AuthenticationResult</a> instance that contains the successfully authenticated account available via its <code>getAccount</code> method, for example, <code>result.getAccount(function(err, account){...});</code>.</table><h4 id="returns">Returns</h4><p>void; If the authentication fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the authentication succeeds, the success <a href="authenticationResult">AuthenticationResult</a> will will be provided to the <code>callback</code> as the callback&#39;s second parameter. The successfully authenticated account may be obtained via the result&#39;s <code>getAccount</code> method, for example, <code>result.getAccount(function(err, account){...});</code>.</p><hr><p><a name="authenticateApiRequest"></a></p><h3 id="-span-class-member-method-span-authenticateapirequest-options-callback-"><span class="member">method</span> authenticateApiRequest(options, callback)</h3><p>This method gives you the ability to perform API Key Authentication for your users, as described in <a href="http://docs.stormpath.com/guides/securing-your-api/">Using Stormpath to Secure and Manage API Services</a></p><p>Used this method to:</p><ul><li>Authenticate users who wish to identify themselves with an ApiKey that has been created on their <a href="account">Account</a>.</li><li>Allow those same users to exchange their ApiKey credentials for an Oauth Access tken</li><li>Authenticate a user who has an Oauth Access token that you have issued to them</li></ul><p>The user will supply the necessary information to you by making an HTTP request to your server. You will pass that request, using the <code>options.request</code> paramter, to this method. This method will to do one of the following, based on the nature of the request:</p><ul><li>Authenticate the user via HTTP Basic Auth, if the <code>Authorization</code> header exists with a value of <code>Basic &lt;Base64 Encoded api_key_id:api_key_secret&gt;</code>.</li><li>Create an Oauth access token if authorization is successful and a token is requested by <code>grant_type=client_credentials</code> in the URL or post body.</li><li>Authenticate the user, using a previously issued Oauth access token which must be provided in one of these locations:<ul><li>In the header as <code>Authorization: Bearer &lt;token&gt;</code></li><li>As the value of the <code>access_token</code> field in a <code>application/www-url-form-encoded</code> post body</li><li>As that value of the <code>access_token</code> query parameter in the request URL. This is not recommened, as query parameters are typically logged in system logs and this would compromise the token. The URL location must be specifically enabled (see parameters table below).</li></ul></li></ul><p>In all situations the <code>callback</code> will be called with either an error, which is descriptive and can be passed back to the user, or an instance of <code>AuthenticationResult</code>, which will have the requested or granted scopes, if this is an Oauth type of request.</p><p>If you will use form-encoded post bodies to pass the <code>grant_type</code> or <code>access_token</code>: it is assumed that you are using a framework such as Express or Restify and that you have enabled the <code>bodyParser</code> in order to populate <code>req.body</code> as an object before passing the request to this function. If you do not this method will assume that no post body is present and will not find any values there.</p><p>This method is useful if you want to support all these operations under one route handler and with one call to our API.</p><h4 id="usage">Usage</h4><p>If you are using a framework such as Express or Restify, just pass along the request object to do basic authoriztion: Pass an object as the first parmeter, and assign the HTTP request to the <code>request</code> property. For example:</p><pre><code class="lang-javascript">// Express.js example - accept Basic or OAuth Access Token for a given resource

app.get(&#39;/protected/resource&#39;, function(req, res) {
  application.authenticateApiRequest({ request: req }, function(err, authResult) {
    authResult.getAccount(function(err, account) {
      var message = &#39;Hello, &#39; + account.username + &#39;! Thanks for authenticating.&#39;;

      if (authResult.grantedScopes) {
        message += &#39; You have been granted: &#39; + authResult.grantedScopes.join(&#39; &#39;);
      }

      res.json({ message: message });
    });
  });
});</code></pre><p>Or if you want to support Oauth Access Token exchange:</p><pre><code class="lang-javascript">// Express.js example - support the exchange of api key credentials for an Oauth Access Token

app.post(&#39;/oauth/token&#39;, function(req, res) {
  application.authenticateApiRequest({
    request: req,

    // determine what scope to give, then return.  This is a synchronous
    // function, don&#39;t use callbacks here.
    scopeFactory: function(account, requestedScopes) {
      return [&#39;granted-scope&#39;];
    }
  }, function(err, authResult) {
    res.json(authResult.tokenResponse);
  });
});</code></pre><p>If you are not using a framework, you may manually construct an object literal for the <code>request</code> value:</p><pre><code class="lang-javascript">// Example object literal for the request, this example is an Oauth Access Token request.

var requestObject = {
  url: &#39;/oauth/token&#39;,
  method: &#39;POST&#39;,
  headers: { &#39;authorization&#39;: &#39;Basic 3HR937281K7QWC5YS37289WPE:MTdncVDALvHcdoY3sjrK+/WgYY3sj3AZx1vZx1v&#39; },
  body: { grant_type: &#39;client_credentials&#39; }
};

application.authenticateApiRequest({ request: requestObject },function(err, authResult) {
  // .. handle the result
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>options</code><td><code>object</code><td>required<td><p>An object literal, with the following properties:</p><ul><li><code>request</code> - REQUIRED - this can be the <code>req</code> object from your framework, or an object literal with the following properties:<ul><li><code>url</code> - REQUIRED - the url of the reuqest, including query parameters</li><li><code>method</code> - REQUIRED - the method of the request, GET or POST depending on the type of request</li><li><code>headers</code> - REQUIRED - an object with an optional <code>authorization</code> property</li><li><code>body</code> - OPTIONAL - an object where the properties corresponded to the form data that was posted</li></ul></li></ul><ul><li><code>locations</code> - OPTIONAL - Where to look for an <code>access_token</code> in the request. It is an array of strings which may contain any of thes values:<ul><li>&#39;header&#39;</li><li>&#39;body&#39;</li><li>&#39;url&#39;</li></ul>Defaults to <code>&#39;header&#39;</code> and <code>&#39;body&#39;</code>. <strong>WARNING:</strong> enabling <code>url</code> is discouraged, passing the <code>access_token</code> in the URL may cause it to be logged in a system log, at which point it would be comprimised.</li></ul><ul><li><code>scopeFactory</code> - OPTIONAL - A function which will be called with <code>(account,requestedScopes)</code> where the account is the successfully authenticated account and <code>requstedScope</code> is the scope(s) that the user requested, as an array of strings. You must return the scope(s) you wish to grant, as an array of strings.</li></ul><ul><li><code>ttl</code> - OPTIONAL - A number, how many seconds this token is valid for.</li></ul><tr><td><code>callback</code><td><code>function</code><td>required<td><p>The callback that will receive the error or an instance of <code>AuthenticationResult</code>. You can inspect <code>authResult</code> for the following properties:</p><ul><li><code>tokenResponse</code> - The object that you should send to the user as a JSON string, if they have requested an Oauth Access token</li><li><code>grantedScopes</code> - The scope(s) that the user can access, given the access token that they presented. It is an array of strings.</li></ul></table><hr><p><a name="createAccount"></a></p><h3 id="-span-class-member-method-span-createaccount-account-options-callback-"><span class="member">method</span> createAccount(account, <em>[options,]</em> callback)</h3><p>Creates a new <a href="account">Account</a> in the application&#39;s <a href="http://docs.stormpath.com/rest/product-guide/#account-store-mapping-default-account-store">default account store</a>.</p><h4 id="usage">Usage</h4><p>Example:</p><pre><code class="lang-javascript">var account = {
  givenName: &#39;Jean-Luc&#39;,
  surname: &#39;Picard&#39;,
  username: &#39;jlpicard&#39;,
  email: &#39;jlpicard@starfleet.com&#39;,
  password: &#39;Changeme1!&#39;
};

application.createAccount(account, function(err, createdAccount) {
  console.log(createdAccount);
});</code></pre><p>Whenever you create an <code>account</code>, an empty <code>customData</code> resource is created for that <code>account</code> automatically, but when you need to populate custom data on <code>account</code> creation you can embed <code>customData</code> directly in <code>account</code> resource.</p><pre><code class="lang-javascript">var account = {
  givenName: &#39;Jean-Luc&#39;,
  surname: &#39;Picard&#39;,
  username: &#39;jlpicard&#39;,
  email: &#39;jlpicard@starfleet.com&#39;,
  password: &#39;Changeme1!&#39;,
  customData: {
    rank: &#39;Captain&#39;,
    birthDate: &#39;2305-07-13&#39;,
    birthPlace: &#39;La Barre, France&#39;,
    favoriteDrink: &#39;Earl Grey tea&#39;
  }
};

application.createAccount(account, function(err, createdAccount) {
  console.log(createdAccount);
});</code></pre><p>You can also specify options to control creation behavior and things like reference expansion:</p><pre><code class="lang-javascript">...

var options = { registrationWorkflowEnabled: false, expand: &#39;directory&#39; };

application.createAccount(account, options, function(err, createdAccount) {
  console.log(createdAccount);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>account</code><td><code>object</code><td>required<td>The account&#39;s name/value fields.<tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as <a href="http://docs.stormpath.com/rest/product-guide/latest/accnt_mgmt.html#add-a-new-account-to-a-directory-no-email">query parameters</a>.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon server response. The 1st parameter is an <code>Error</code> object. The 2nd parameter is the newly created <a href="account">Account</a> resource returned from the server.</table><h4 id="returns">Returns</h4><p>void; the created <a href="account">Account</a> returned from the server will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="createAccountStoreMapping"></a></p><h3 id="-span-class-member-method-span-createaccountstoremapping-accountstoremapping-callback-"><span class="member">method</span> createAccountStoreMapping(accountStoreMapping, callback)</h3><p>Creates an instance of <a href="accountStoreMapping">AccountStoreMapping</a> from the <code>accountStoreMapping</code> literal and associate it with current application. Returns a newly created <a href="accountStoreMapping">AccountStoreMapping</a> as a second callback parameter.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">var mapping = {
  accountStore: {
    href: &quot;https://api.stormpath.com/v1/directories/bckhcGMXQDujIXpExAmPLe&quot;
  },
  isDefaultAccountStore: true,
  isDefaultGroupStore: true
};

application.createAccountStoreMapping(mapping, function(err, asm) {
  var accountStoreMapping = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>accountStoreMapping</code><td><code>object</code><td>required<td>An object literal which contains an <code>accountStore</code> property that references the account store that you want to add to this Application. Can be a <a href="directory">Directory</a>, <a href="group">Group</a>, or <a href="organization">Organization</a>.<tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="createGroup"></a></p><h3 id="-span-class-member-method-span-creategroup-group-options-callback-"><span class="member">method</span> createGroup(group, <em>[options,]</em> callback)</h3><p>Creates a new <a href="group">Group</a> in the application&#39;s <a href="http://docs.stormpath.com/rest/product-guide/#account-store-mapping-default-group-store">default group store</a>.</p><h4 id="usage">Usage</h4><p>Example:</p><pre><code class="lang-javascript">var group = { name: &#39;Administrators&#39; };

application.createGroup(group, function(err, createdGroup) {
  console.log(createdGroup);
});</code></pre><p>You can also specify options to control things like reference expansion:</p><pre><code class="lang-javascript">application.createGroup(group, { expand:&#39;directory&#39; }, function(err, createdGroup) {
  console.log(createdGroup);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>group</code><td><code>object</code><td>required<td>The group&#39;s name/value fields.<tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon server response. The 1st parameter is an <code>Error</code> object. The 2nd parameter is the newly created <a href="group">Group</a> resource returned from the server.</table><h4 id="returns">Returns</h4><p>void; the created <a href="group">Group</a> returned from the server will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="createIdSiteUrl"></a></p><h3 id="-span-class-member-method-span-createidsiteurl-options-"><span class="member">method</span> createIdSiteUrl(options)</h3><p>Creates a URL which will redirect a user to your ID Site. The URL will have the query param <code>?jwtRequest=&lt;token&gt;</code> appended to it. This token is required when sending a user to your ID Site and is signed with your api key for protection. To send the user to your ID site, simply Issue a <code>302</code> redirect and set the <code>Location</code> header to the URL that you get from this method.</p><p>For more information, see the <a href="http://docs.stormpath.com/guides/using-id-site">ID Site Feature Guide</a></p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">// Express.js example

app.get(&#39;/login&#39;, function(req, res) {
  var url = application.createIdSiteUrl({ callbackUri: &#39;https://www.mysite.com/dashboard&#39; });

  res.writeHead(302, {
    &#39;Cache-Control&#39;: &#39;no-store&#39;,
    &#39;Pragma&#39;: &#39;no-cache&#39;,
    &#39;Location&#39;: url
  });
  res.end();
});

app.get(&#39;/logout&#39;, function(req, res) {
  var url = application.createIdSiteUrl({
    callbackUri: &#39;https://www.mysite.com/home&#39;,
    logout: true
  });

  res.writeHead(302, {
    &#39;Cache-Control&#39;: &#39;no-store&#39;,
    &#39;Pragma&#39;: &#39;no-cache&#39;,
    &#39;Location&#39;: url
  });
  res.end();
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>options</code><td><code>object</code><td>required<td><p>An options object, the following properties are supported:</p><ul><li><code>callbackUri</code> - REQUIRED - the fully-qualified location where the user should be sent after they authenticate, e.g. <em><a href="https://www.mysite.com/dashboard">https://www.mysite.com/dashboard</a></em>. For security reasons, the domain <em>www.mysite.com</em> must be registered in your ID Site configuration in the Stormpath Admin Console.</li><li><code>logout</code> - OPTIONAL - If true, the user will be logged out of their session and redirected to the sepcified callbackUri.</li><li><code>organizationNameKey</code> - OPTIONAL - The organization name to display on ID Site. This value will be fixed and the user cannot change it.</li><li><code>path</code> - OPTIONAL - Sets the initial path in the ID Site where the user should be sent. If unspecified, this defaults to /, implying that the ID Site&#39;s landing/home page is the desired location. Most Stormpath customers allow their ID Site&#39;s default landing page <code>/</code> to reflect a traditional &#39;Login or Signup&#39; page for convenience. However, if you know that an end-user is attempting to register, and your ID Site&#39;s user registration form is located at /register, you would set the path to <code>/register</code> to send the user directly there. For example, if you are using the default ID Site provided by Stormpath, you can send the user directly to the registration page by specifying <code>/#/register</code> or the forgot password page by specifying <code>/#/forgot</code></li><li><code>showOrganizationField</code> - OPTIONAL - Shows the organization field on ID Site, if the user can select from multiple organizations (depends on account store mappings of the application).</li><li><code>state</code> - OPTIONAL - Application-specific state that should be retained and made available to your callbackUri when the user returns from the ID Site. See <a href="application#handleIdSiteCallback">handleIdSiteCallback</a></li><li><code>useSubDomain</code> - OPTIONAL - Use organization name key as domain prefix for ID Site URL. For example, if <code>organizationNameKey</code> is <code>org-a</code> then the user will be redirected to <code>org-a.myidsitedomain.tld</code></li></ul></table><hr><p><a name="getSamlPolicy"></a></p><h3 id="-span-class-member-method-span-getsamlpolicy-options-callback-"><span class="member">method</span> getSamlPolicy(<em>[options,]</em> callback)</h3><p>Retrieves the application&#39;s <a href="samlPolicy">SamlPolicy</a> and provides it to the specified <code>callback</code>.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getSamlPolicy(function(err, samlPolicy) {
  console.log(samlPolicy);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a>.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon resource retrieval. The 1st parameter is an <code>Error</code> object. The 2nd parameter is the retrieved <a href="samlPolicy">SamlPolicy</a> resource.</table><h4 id="returns">Returns</h4><p>void; the retrieved <code>SamlPolicy</code> resource will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="getAccounts"></a></p><h3 id="-span-class-member-method-span-getaccounts-options-callback-"><span class="member">method</span> getAccounts(<em>[options,]</em> callback)</h3><p>Retrieves a <a href="collectionResource">collection</a> of the application&#39;s accessible <a href="account">Account</a>s and provides the collection to the specified <code>callback</code>.</p><p>If no options are specified, all of the application&#39;s accounts are retrieved. If options (query parameters) are specified for a search, only those accounts matching the search will be retrieved. If the search does not return any results, the collection will be empty.</p><h4 id="usage">Usage</h4><p>If you want to retrieve <em>all</em> of the application&#39;s accounts:</p><pre><code class="lang-javascript">application.getAccounts(function(err, accounts) {
  accounts.each(function(account, cb) {
    console.log(&#39;account:&#39;, account);
    cb();
  }, function(err) {
    console.log(&#39;Finished iterating over accounts.&#39;);
  });
});</code></pre><p>As you can see, the <a href="collectionResource">Collection</a> provided to the <code>callback</code> has an <code>each</code> function that accepts its own callback. The collection will iterate over all of the accounts in the collection, and invoke the callback for each one. The <code>offset</code> parameter indicates the index of the account in the returned collection. The <code>offset</code> parameter is optional - it may be omitted from the callback definition.</p><p>If you don&#39;t want all accounts, and only want specific ones, you can search for them by specifying the <em>options</em> argument with <a href="http://docs.stormpath.com/rest/product-guide/#application-accounts-search">application account search</a> query parameters:</p><pre><code class="lang-javascript">application.getAccounts({ username: &#39;*foo*&#39; }, function(err, accounts) {
  accounts.each(function(account, cb) {
    console.log(&#39;account:&#39;, account);
    cb();
  }, function(err) {
    console.log(&#39;Finished iterating over accounts.&#39;);
  });
});</code></pre><p>The above code example would only print out accounts with the text fragment <code>foo</code> in the username. See the Stormpath REST API Guide&#39;s <a href="http://docs.stormpath.com/rest/product-guide/#application-accounts-search">application account search documentation</a> for other supported query parameters, such as reference expansion.</p><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/#application-accounts-search">application account search</a> or reference expansion.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon resource retrieval. The 1st parameter is an <code>Error</code> object. The 2nd parameter is a <a href="collectionResource">collection</a> containing zero or more <a href="account">Account</a> resources.</table><h4 id="returns">Returns</h4><p>void; the retrieved collection of <code>Account</code>s will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="getApiKey"></a></p><h3 id="-span-class-member-method-span-getapikey-apikeyid-em-options-em-callback-"><span class="member">method</span> getApiKey(apiKeyId, <em>[options,]</em> callback)</h3><p>Retrieves the specified ApiKey for an Account that may login to the Application (as determined by the application&#39;s <a href="accountStoreMapping">mapped account stores</a> ). If the API Key does not correspond to an Account that may login to the application, and error is provided to the callback.</p><p>When retrieving the API Key from Stormpath, it is doubly encrypted: in transit over SSL by default, but also the API Key secret is additionally encrypted to ensure that nothing before or after SSL transit may even see the secret. Additionally, API Key secret values remain encrypted if caching is enabled, so you don’t have to worry if your cache supports encryption.</p><p>This all happens by default; there is nothing you need to configure to obtain these benefits. However, if you would like to customize the secondary encryption options, you may do so:</p><p>For those interested, password-based AES 256 encryption is used: the password is the API Key Secret you used to configure the SDK Client. The PBKDF2 implementation will use 1024 iterations by default to derive the AES 256 key. At the risk of potentially decreased security, you can use the <code>options</code> argument to specify a lower level of encryption key size, like 192 or 128. You can also request a lower number of key iterations. This can reduce the CPU time required to decrypt the key after transit or when retrieving from cache. It is not recommended to go much lower than 1024 (if at all) in security sensitive environments.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getApiKey(&#39;an api key id&#39;, function(err, apiKey) {
  console.log(apiKey);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>apiKeyId</code><td><code>string</code><td>required<td>The Api Key Id for which you want the matching account.<tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td><p>An object which allows you to modify the query parameters for this request, the following properties are valid:</p><ul><li><code>encryptionKeySize</code> - Set to <code>128</code> or <code>192</code> to change the AES key encryption size</li><li><code>encryptionKeyIterations</code> - Defaults to <code>1024</code></li></ul><tr><td><code>callback</code><td><code>function</code><td>required<td>The function to call when the request is complete, it will be called with an error or an <code>ApiKey</code> instance which contains an expanded <code>account</code> property.</table><hr><p><a name="getCustomData"></a></p><h3 id="-span-class-member-method-span-getcustomdata-options-callback-"><span class="member">method</span> getCustomData(<em>[options,]</em> callback)</h3><p>Retrieves the <a href="customData">CustomData</a> resource of the <code>Application</code> and provides it to the specified <code>callback</code>.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getCustomData(function(err, customData) {
  console.log(customData);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>An object literal of name/value pairs to use as query parameters, for example, <a href="http://docs.stormpath.com/rest/product-guide/#account-retrieve">resource expansion</a>.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon resource retrieval. The 1st parameter is an <code>Error</code> object. The 2nd parameter is the retrieved <a href="customData">CustomData</a> resource.</table><h4 id="returns">Returns</h4><p>The retrieved <code>CustomData</code> resource will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="getGroups"></a></p><h3 id="-span-class-member-method-span-getgroups-options-callback-"><span class="member">method</span> getGroups(<em>[options,]</em> callback)</h3><p>Retrieves a <a href="collectionResource">collection</a> of the application&#39;s accessible <a href="group">Group</a>s and provides the collection to the specified <code>callback</code>.</p><p>If no options are specified, all of the application&#39;s groups are retrieved. If options (query parameters) are specified for a search, only those groups matching the search will be retrieved. If the search does not return any results, the collection will be empty.</p><h4 id="usage">Usage</h4><p>If you want to retrieve <em>all</em> of the application&#39;s groups:</p><pre><code class="lang-javascript">application.getGroups(function(err, groups) {
  groups.each(function(group, cb) {
    console.log(&#39;group:&#39;, group);
    cb();
  }, function(err) {
    console.log(&#39;Finished iterating over groups.&#39;);
  });
});</code></pre><p>As you can see, the <a href="collectionResource">collection</a> provided to the <code>callback</code> has an <code>each</code> function that accepts its own callback. The collection will iterate over all of the groups in the collection, and invoke the callback for each one. The <code>offset</code> parameter indicates the index of the group in the returned collection. The <code>offset</code> parameter is optional - it may be omitted from the callback definition.</p><p>If you don&#39;t want all groups, and only want specific ones, you can search for them by specifying the <em>options</em> argument with <a href="http://docs.stormpath.com/rest/product-guide/#application-groups-search">application group search</a> query parameters:</p><pre><code class="lang-javascript">application.getGroups({ name: &#39;*bar*&#39; }, function(err, groups) {
  groups.each(function(group, cb) {
    console.log(&#39;group:&#39;, group);
    cb();
  }, function(err) {
    console.log(&#39;Finished iterating over groups.&#39;);
  });
});</code></pre><p>The above code example would only print out groups with the text fragment <code>foo</code> in their name. See the Stormpath REST API Guide&#39;s <a href="http://docs.stormpath.com/rest/product-guide/#application-groups-search">application group search documentation</a> for other supported query parameters, such as reference expansion.</p><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/#application-groups-search">application group search</a> or reference expansion.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon resource retrieval. The 1st parameter is an <code>Error</code> object. The 2nd parameter is a <a href="collectionResource">collection</a> containing zero or more <a href="group">Group</a> resources.</table><h4 id="returns">Returns</h4><p>void; the retrieved collection of <code>Group</code>s will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="getTenant"></a></p><h3 id="-span-class-member-method-span-gettenant-options-callback-"><span class="member">method</span> getTenant(<em>[options,]</em> callback)</h3><p>Retrieves the application&#39;s owning <a href="tenant">Tenant</a> and provides it to the specified <code>callback</code>.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getTenant(function(err, tenant) {
  console.log(tenant);
});</code></pre><p>You can also use <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a> options (query params) to obtain linked resources in the same request:</p><pre><code class="lang-javascript">application.getTenant({ expand:&#39;directories&#39; }, function(err, tenant) {
  console.log(tenant);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a>.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon resource retrieval. The 1st parameter is an <code>Error</code> object. The 2nd parameter is the retrieved <a href="tenant">Tenant</a> resource.</table><h4 id="returns">Returns</h4><p>void; the retrieved <code>Tenant</code> resource will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="handleIdSiteCallback"></a></p><h3 id="-span-class-member-method-span-handleidsitecallback-requesturl-callback-"><span class="member">method</span> handleIdSiteCallback(requestUrl, callback)</h3><p>This method should be called when processing an HTTP request sent by the ID Site to the <code>callbackUri</code> specified via the <a href="application#createIdSiteUrl">createIdSiteUrl()</a> method. You should provide the entire URL of the request, including all query paramaters.</p><p>For more information, see the <a href="http://docs.stormpath.com/guides/using-id-site">ID Site Feature Guide</a></p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">// Express.js example, assumes you set &#39;/dashboard&#39; as the callbackUri when calling application.createIdSiteUrl()

app.get(&#39;/dashboard&#39;, function(req,res) {
  application.handleIdSiteCallback(req.url, function(err, idSiteResult) {
    var account = idSiteResult.account;
    // render the user dashboard for this account
  });
})</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>requestUrl</code><td><code>string</code><td>required<td>The request URL, including all query parameters<tr><td><code>callback</code><td>function<td>required<td>The callback to execute when the method is complete. If successful, an <code>idSiteResult</code> result will be given as the second argument. Otherwise and error will be returned as the first argument.</table><h4 id="-object-idsiteresult-"><em>Object</em> idSiteResult {}</h4><p>This object represents a successful ID Site callback and has the following properties:</p><table><thead><tr><th>name<th>type<th>description<tbody><tr><td><code>account</code><td><code>object</code> <code>Account</code><td>The account that was authenticated, this is an instance of <a href="account">Account</a><tr><td><code>isNew</code><td><code>boolean</code><td>A boolean indicating if this account was newly registered at the ID Site<tr><td><code>state</code><td><code>string</code><td>The application-specific state you you passed as an option to <a href="application#createIdSiteUrl">createIdSiteUrl()</a><tr><td><code>status</code><td><code>string</code><td>Indicates the user activty on the ID Site. <code>AUTHENTICATED</code> if the user has authenticated, or <code>LOGOUT</code> if the user has logged out.</table><hr><p><a name="sendPasswordResetEmail"></a></p><h3 id="-span-class-member-method-span-sendpasswordresetemail-options-callback-"><span class="member">method</span> sendPasswordResetEmail(options, callback)</h3><p>Triggers the <a href="http://docs.stormpath.com/rest/product-guide/#application-password-reset">password reset workflow</a> by sending an email to the account matching the specified <code>email</code> property. This will result in a newly created <code>PasswordResetToken</code> resource which will be provided to the specified <code>callback</code>. The corresponding account can be retrieved, using the account HREF that is provided on the <code>PasswordResetToken</code> object.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.sendPasswordResetEmail({ email: &#39;foo@bar.com&#39; }, function(err, passwordResetToken) {
  // The token is the last part of the HREF
  console.log(passwordResetToken.href.split(&#39;/&#39;).pop());

  // The account can be retrieved by using the account href on the result
  client.getAccount(passwordResetToken.account.href, function(err, account) {
    console.log(account);
  });
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>options</code><td><code>string</code><td>required<td>An object literal with the following properties:<li><code>email</code> - REQUIRED - the email of the account that you wish to reset the password for</li><li><code>accountStore</code> - OPTIONAL - for specifying the account store to find the account in, e.g. <code>{ accountStore: { href: &#39;HREF_OF_STORE&#39; }}</code></li><tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a> (e.g. if an account was not found). The 2nd parameter is an <code>PasswordResetToken</code> that references the emailed account via its <code>account</code> field, for example, <code>passwordResetToken.account.href</code>.</table><hr><p><a name="verifyPasswordResetToken"></a></p><h3 id="-span-class-member-method-span-verifypasswordresettoken-token-callback-"><span class="member">method</span> verifyPasswordResetToken(token, callback)</h3><p>Use this method to verify a passowrd reset token. If you do not get an error, the token is valid and can be used with the <a href="application#resetPassword">resetPassword</a> method to set a new password for the user.</p><p>Use this method if you want to verify the token before you ask the user to submit a new password.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">
var sptoken = request.query.sptoken; // get the sptoken from the request URL

application.verifyPasswordResetToken(sptoken, function(err, verificationResponse) {
  if (err) {
    // The token has been used or is expired, have user request a new token
  } else {
    // Show the user a form which allows them to reset their password
    client.getAccount(verificationResponse.account.href, function(err, account) {
      console.log(account);
    });
  }
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>token</code><td><code>string</code><td>required<td>The <code>sptoken</code> query parameter in a <a href="http://docs.stormpath.com/rest/product-guide/#application-password-reset">password reset workflow</a>.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a> if the token is not found or has expired. The 2nd parameter, a <code>verificationResponse</code>, can be used to set a new password and complete the flow.</table><h4 id="-object-verificationresponse-"><em>Object</em> verificationResponse {}</h4><p>This object represents a found password reset token and the account that it was created for</p><table><thead><tr><th>Property Name<th>Type<th>Description<tbody><tr><td><code>account</code><td><code>object</code><td>Contains an <code>href</code> property which indicates the account which this token is for<tr><td><code>email</code><td><code>string</code><td>The email address which received this password reset token</table><hr><p><a name="resetPassword"></a></p><h3 id="-span-class-member-method-span-resetpassword-token-password-callback-"><span class="member">method</span> resetPassword(token, password, callback)</h3><p>Completes the <a href="http://docs.stormpath.com/rest/product-guide/#application-password-reset">password reset workflow</a> by setting a new password for an account. On success, the response will include a link to the account that the password was reset on. This call on success will send the password change confirmation email that was configured in the Administrator Console to the email account associated with the account.</p><p>This call will &quot;consume&quot; the token, and it will no longer be valid.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">
var token = req.body.token;
var password = req.body.password;

application.resetPassword(token, password, function(err, result) {
  if (err) {
    // The token has been used or is expired, have user request a new token
  }

  // The response contains a link to the account which is associated
  // with this password reset workflow:
  console.log(result.account.href);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>token</code><td><code>string</code><td>required<td>The <code>sptoken</code> query parameter in a <a href="http://docs.stormpath.com/rest/product-guide/#application-password-reset">password reset workflow</a>.<tr><td><code>password</code><td><code>string</code><td>required<td>The <code>password</code> parameter in a <a href="http://docs.stormpath.com/rest/product-guide/#application-password-reset">password reset workflow</a>. Will be set as account password.<tr><td><code>callback</code><td>function<td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is a result which contains a link to the account that is associated with this password reset token.</table><hr><p><a name="getAccount"></a></p><h3 id="-span-class-member-method-span-getaccount-provideroptions-options-callback-"><span class="member">method</span> getAccount(providerOptions, <em>[options,]</em> callback)</h3><p>Retrieves or creates an <code>Account</code> if the application has an associated <code>Account Store</code> which is a social provider store. The specified <code>callback</code> is called with an error or <code>providerAccountResult</code> object.</p><p>For a detailed explanation of how to retrieve access tokens from Facebook or Google, please read <a href="http://docs.stormpath.com/guides/social-integrations/">Integrating Stormpath with Facebook and Google</a> and review the samples folder in the SDK.</p><h4 id="usage">Usage</h4><p>In this example we have obtained a Google access token from the user and we are using it to fetch the associated account from Stormpath.</p><pre><code class="lang-javascript">
var options = {
  providerData: {
    providerId: &#39;google&#39;,
    accessToken: &#39;abc1235&#39;
  }
};

application.getAccount(options, function(err, providerAccountResult) {
  if (providerAccountResult.created) {
    console.log(&#39;Just created a new user&#39;);
  }

  console.log(providerAccountResult.account);
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>providerOptions</code><td><code>object</code><td>required<td>An object literal, with the following properties:<ul><li><code>providerData</code> - REQUIRED - an object literal with the following properties:</li><ul><li><code>providerId</code> - REQUIRED - either &#39;google&#39; or &#39;facebook&#39;</li><li><code>accessToken</code> - OPTIONAL - the access token that you have acquired from the provider. Use this if you have not requested offline access to the user&#39;s data.</li><li><code>code</code> - OPTIONAL - the access code that you have acquired from the provider. Use this if you HAVE requested offline access to the user&#39;s data.</li></ul></ul><tr><td><code>options</code><td><code>object</code><td>optional<td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a>.<tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon resource retrieval. The 1st parameter is an <code>Error</code> object. The 2nd parameter is the retrieved <code>ProviderData</code> resource.</table><h4 id="-object-provideraccountresult-"><em>Object</em> providerAccountResult {}</h4><p>This object represents a successful retrieval or creation of the Stormpath Account that is associated with the user that provided the access token.</p><table><thead><tr><th>name<th>type<th>description<tbody><tr><td><code>account</code><td><code>object</code> <code>Account</code><td>The account that was authenticated, this is an instance of <a href="account">Account</a><tr><td><code>created</code><td><code>boolean</code><td>A boolean indicating if this account was newly created</table><hr><p><a name="getAccountStoreMappings"></a></p><h3 id="-span-class-member-method-span-getaccountstoremappings-options-callback-"><span class="member">method</span> getAccountStoreMappings(<em>[options,]</em> callback)</h3><p>Retrieves the Collection of <code>AccountStoreMappings</code> and provides it to the specified <code>callback</code>.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getAccountStoreMappings({ expand: &#39;accountStore&#39; }, function(err, asm) {
  var accountStoreMappings = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a>.<tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="getDefaultAccountStore"></a></p><h3 id="-span-class-member-method-span-getdefaultaccountstore-options-callback-"><span class="member">method</span> getDefaultAccountStore(<em>[options,]</em> callback)</h3><p>Retrieve a default <code>AccountStoreMapping</code> for storing accounts and provides it to the specified <code>callback</code>. If default Account Store not set, <code>callback</code> will be called without parameters.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getDefaultAccountStore({ expand: &#39;accountStore&#39; }, function(err, asm) {
  var accountStoreMappings = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a>.<tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="getDefaultGroupStore"></a></p><h3 id="-span-class-member-method-span-getdefaultgroupstore-options-callback-"><span class="member">method</span> getDefaultGroupStore(<em>[options,]</em> callback)</h3><p>Retrieves default <code>AccountStoreMapping</code> for storing <code>Groups</code> and provides it to the specified <code>callback</code>. If default Group Store not set, <code>callback</code> will be called without parameters.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.getDefaultAccountStore({ expand: &#39;accountStore&#39; }, function(err, asm) {
  var accountStoreMappings = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><em><code>options</code></em><td><code>object</code><td><em>optional</em><td>Name/value pairs to use as query parameters, for example, for <a href="http://docs.stormpath.com/rest/product-guide/latest/reference.html#links">resource expansion</a>.<tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="setDefaultAccountStore"></a></p><h3 id="-span-class-member-method-span-setdefaultaccountstore-store-callback-"><span class="member">method</span> setDefaultAccountStore(store, callback)</h3><p>Sets default <code>store</code> (<code>Group</code> or <code>Directory</code>) for storing <code>Application</code>&#39;s <code>accounts</code>. Returns a newly created <code>AccountStoreMapping</code> as a second callback parameter.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.setDefaultAccountStore(directory, function(err, asm) {
  var accountStoreMapping = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>store</code><td><code>object</code><td>required<td>If an <code>object</code>, an instance of <code>Group</code> or <code>Directory</code>. If a <code>string</code>, the <code>href</code> of a Directory or Group resource.<tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="setDefaultGroupStore"></a></p><h3 id="-span-class-member-method-span-setdefaultgroupstore-store-callback-"><span class="member">method</span> setDefaultGroupStore(store, callback)</h3><p>Sets default <code>store</code> (<code>Directory</code>) for storing <code>Application</code>&#39;s <code>groups</code>. Returns a newly created <code>AccountStoreMapping</code> as a second callback parameter.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.setDefaultGroupStore(directory, function(err, asm) {
  var accountStoreMapping = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>store</code><td><code>object</code> or <code>string</code><td>required<td><p>If an <code>object</code>, an instance of <code>Directory</code>. If a <code>string</code>, the <code>href</code> of a Directory resource.</p><tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p><hr><p><a name="addAccountStore"></a></p><h3 id="-span-class-member-method-span-addaccountstore-store-callback-"><span class="member">method</span> addAccountStore(store, callback)</h3><p>Creates an instance of <code>AccountStoreMapping</code>, associate it with current <code>application</code> and sets it&#39;s <code>accountStore</code> to provided <code>store</code> Returns a newly created <code>AccountStoreMapping</code> as a second callback parameter.</p><h4 id="usage">Usage</h4><pre><code class="lang-javascript">application.addAccountStore(directory, function(err, asm) {
  var accountStoreMapping = asm;
});</code></pre><h4 id="parameters">Parameters</h4><table class="table table-striped table-hover table-curved"><thead><tr><th>Parameter<th>Type<th>Presence<th>Description<th><tbody><tr><td><code>store</code><td><code>object</code><td>required<td>An instance of <code>Directory</code> or <code>Group</code><tr><td><code>callback</code><td><code>function</code><td>required<td>The callback to execute upon server response. The 1st parameter is an <a href="resourceError">error</a>. The 2nd parameter is an <a href="accountStoreMapping">AccountStoreMapping</a> instance.</table><h4 id="returns">Returns</h4><p>void; If the request fails, the callback&#39;s first parameter (<code>err</code>) will report the failure. If the request succeeds, the instance of <a href="accountStoreMapping">AccountStoreMapping</a> will be provided to the <code>callback</code> as the callback&#39;s second parameter.</p>
